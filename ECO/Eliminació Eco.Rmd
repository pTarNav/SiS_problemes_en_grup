---
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*Senyals i Sistemes* (*2020-2021*)

Pol Costa, Pol Rosinés, Pol Vilavella, Pau Tarragó

## **Eliminació de l'eco**

#### **a)**
$$
y[n] = x[n] + ax[n-N] \\
y[n] = x[n]*h_1[n] \implies h_1[n] = \delta[n] + a[n-N]
$$

#### **b)**
$$
z[n] = y[n] -bz[n-N]
$$
Per trobar la resposta impulsional com $z[n]$ és recursiva hem de trobar una forma de representar-la només en funció de $y[n]$. Si anem extenent la recursió veiem que segueix el següent patró:
$$
z[n] = y[n] -bz[n-N]\\
z[n] = y[n] -b(y[n-N] -bz[n-2N]) \\
\vdots \\
z[n] = y[b] -b(y[n-N] -b(y[n-2N] -b(...))) = \sum\limits_{k=0}^{\infty} (-b)^ky[n-kN] \\
z[n] = y[n]*(\sum\limits_{k=0}^{\infty} (-b)^k\delta[n-kN]) \implies h_2[n] = \sum\limits_{k=0}^{\infty} (-b)^k\delta[n-kN]
$$

#### **c)**
$$
z[n] = x[n] \\
z[n] = y[n]*h_2[n] = (x[n]*h_1[n])*h_2[n] = x[n]*(h_1[n]*h_2[n]) \\
x[n] = x[n]*\delta[n] \\
$$
$$
x[n]*(h_1[n]*h_2[n]) = x[n]*\delta[n] \implies h_1[n]*h_2[n] = \delta[n]
$$

#### **d)**
$$
h_1[n]*h_2[n] = \delta[n] \\
(\delta[n] + a\delta[n-N])*(h_2[n]) = \delta[n] \\
h_2[n] + ah_2[n-N] = \sum\limits_{k=0}^{\infty} (-b)^k\delta[n-kN] + a\sum\limits_{k=0}^{\infty} (-b)^k\delta[n-(k+1)N] \\
\sum\limits_{k=0}^{\infty} (-b)^k\delta[n-kN] + a(-b)^k\delta[n-(k+1)N]
$$
Es pot observar que la segona part del sumatori és quasi equivalent a la primera, l'únic que a l'instant $[n -kN], k \neq 0$ en comptes de donar el valor $(-b)^k$ la delta et dona $(-b)^{k-1}$ i per $k=0$ podem observar que tota aquesta expressió només resulta en $\delta[n]$:
$$
\sum\limits_{k=0}^{\infty} (-b)^k\delta[n-kN] + a(-b)^k\delta[n-(k+1)N] = \delta[n] + \sum\limits_{k=1}^{\infty} (-b)^k\delta[n-kN] + a(-b)^{k-1}\delta[n-kN]  = \delta[n]\\
\implies \sum\limits_{k=1}^{\infty} (-b)^k\delta[n-kN] + a(-b)^{k-1}\delta[n-kN] = 0 \\
\sum\limits_{k=1}^{\infty} (-b)^{k-1}(-b\delta[n-kN] + a\delta[n-kN]) = \sum\limits_{k=1}^{\infty} (a-b)(-b)^{k-1}\delta[n-kN] = 0\\
(a-b)\sum\limits_{k=1}^{\infty} (-b)^{k-1}\delta[n-kN] = 0 \implies b = a
$$

Una altra manera de corroborar el resultat és:
$$
z[n] = y[n] -bz[n-N] = x[n] + ax[n-N] -bz[n-N] \\
z[n] = x[n] \implies x[n] + ax[n-N] -bx[n-N] = x[n] \\
\implies ax[n-N] -bx[n-N] = 0 \implies b = a
$$

#### **e)**
$$
R_{yy}[m] = y[m]*y^*[-m] \\
y[m] \in \mathbb{R} \implies R_{yy}[m] = y[m]*y[-m] \\
R_{yy}[m] = (x[m]*h_1[m])*(x[-m]*h_1[-m]) = (x[m]*x[-m])*(h_1[m]*h_1[-m]) = R_{xx}[m]*(h_1[m]*h_1[-m])\\
$$
$$
(h_1[m]*h_1[-m]) = (\delta[m] + a\delta[m-N])*(\delta[-m] + a\delta[-m-N])\\
$$
$$
\delta[m] = \delta[-m] \\
\delta[-m-N] = \delta[m+N] \\
\delta[m-N]*\delta[m+N] = \delta[m]
$$
$$
(h_1[m]*h_1[-m]) = \delta[m] + a\delta[m-N] + a\delta[m+N] + a^2\delta[m] = \\
= (1+a^2)\delta[m] + a\delta[m-N] + a\delta[m+N]
$$
$$
R_{yy}[m] = R_{xx}[m]*((1+a^2)\delta[m] + a\delta[m-N] + a\delta[m+N]) = (1+a^2)R_{xx}[m] + aR_{xx}[m-N] + aR_{xx}[m+N]
$$

#### **f)**
Sabem que $R_{yy}[0], R_{yy}[N] = R_{yy}[-N]$ són màxims que es poden extreure de la senyal $y[n]$ directament i per tant $N$ és la distància de mostres entre el màxim $R_{yy}[0]$ i $R_{yy}[N]$, a més $R_{xx}[0] >> R_{xx}[N]$, aleshores:
$$
R_{yy}[0] = (1+a^2)R_{xx}[0] + aR_{xx}[-N] + aR_{xx}[N] = (1+a^2)R_{xx}[0]\\
R_{yy}[N] = (1+a^2)R_{xx}[N] + aR_{xx}[0] + aR_{xx}[2N] = aR_{xx}[0]\\
\implies \frac{R_{yy}[0]}{(1+a^2)} = \frac{R_{yy}[N]}{a} \implies a^2R_{yy}[N] -aR_{yy}[0] + R_{yy}[N] = 0 \\
\implies a = \frac{R_{yy}[0] \pm \sqrt{R_{yy}[0]^2 - 4R_{yy}[N]^2}}{2R_{yy}[N]}
$$